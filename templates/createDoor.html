<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anywhere Door Collection</title>
    <link rel="stylesheet" href="../static/style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800&family=Lexend:wght@400;500;600;700;800&family=Piazzolla:wght@400;500;600;700;900&family=Shippori+Mincho:wght@400;500;600;700;800&family=Sora:wght@400;500;600;700;800&family=Syne:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <style>
        .outer_container {
            display: flex;
            height: 100vh;
            /* Full viewport height */
            width: 70%;
            /* Take the full width of the viewport */
            justify-content: center;
            /* Center the containers horizontally */
            margin: 0 auto;
            /* Center the outer container in case it's narrower than the viewport */
        }

        .container {
            flex: 1;
            /* Each container takes an equal fraction of the horizontal space */
            display: flex;
            flex-direction: column;
            /* Aligns child elements (like .scrollable-column) vertically */
            align-items: center;
            /* Center-aligns the child elements horizontally */
            overflow: hidden;
            /* Prevents overflow of child elements */
            margin-top: 0px;
            /* Adjust the top margin as necessary */
        }

        .scrollable-column {
            flex: 1;
            /* Takes up the full available space in its flex container (.container) */
            width: 80%;
            /* Makes sure the width spans the entire space of its parent */
            overflow-y: auto;
            /* Enables vertical scrolling */
            padding: 10px;
            scrollbar-width: none;
            /* For Firefox */
            -ms-overflow-style: none;
            /* For Internet Explorer and Edge */
        }

        .scrollable-column::-webkit-scrollbar {
            display: none;
            /* Hides the scrollbar in WebKit browsers like Chrome and Safari */
        }


        img {
            width: 100%;
            margin-bottom: 10px;
            cursor: pointer;
            filter: grayscale(100%);
            transition: filter 0.3s ease-in-out;
        }

        img.active {
            filter: none;
            /* Full color for active image */
        }



       #frame-container {
            margin-top: 20vh;
        }


        #inner-container {
            margin-top: 20vh;
        }


        .image-container {
            display: block;
            width: 80%;
            margin: 120px auto 0px;
        }

        .image-container img {
            width: 100%;
            margin-bottom: 20px;
            filter: none;
        }



        .option {
            display: block;
            width: 30px;
            height: 30px;
            margin: 10px;
            border-radius: 50%;
            background: rgb(136, 188, 116);
            cursor: pointer;
            transition: transform 0.4s ease 0s;
            border: 1px solid rgb(0, 0, 0);
        }

        .optionarray {
            display: flex;
            align-items: center;
            /* Vertically aligns the options within the array */
            justify-content: space-around;
            /* Distributes the options evenly horizontally */
            width: 100%;
            /* Takes the full width to utilize space for spreading the options */
            margin-top: 20px;
            /* Provides vertical spacing from the image-container */
        }

        .pickYourDoor{
            display: block;
            font-weight: 600;
            top: 0px;
            left: 0px;
            right: 0px;
            margin: 80px auto 0px;
            text-align: center;
        }

        .whereToGo {
            position: fixed;
            bottom: 30px;
            right: 40px;
            width: 200px;
            padding: 15px 0px;
            display: flex;
            flex-direction: column;
            -webkit-box-pack: center;
            justify-content: center;
            -webkit-box-align: center;
            align-items: center;
            text-align: center;
            border: 1px solid black;
            font-weight: normal;
            cursor: pointer;
        }

        .forwardArrow {
            width: 30px;
            margin-top: 5px;
            transform: rotate(180deg);
        }

        .backArrow {
            width: 30px;
            margin-top: 5px;
        }



    </style>
</head>

<body>

    <div id="text">
        <div id="title">
            <a href="/">Anywhere <br> Door <br> Collection </a>
        </div>
    </div>


    <div class="outer_container">

        <div class="container">
            <div class="scrollable-column">
                <div id="frame-container"></div>
            </div>

        </div>

        <div class="container">

            <h2 id="text" class="pickYourDoor"> Pick Your Door </h2>

            <div class="image-container">
                <img id="resultImage" alt="Resulting Image">
            </div>

            <div class="optionarray">
                <div onclick="updateDoorColor('green')" class="option" style="background: rgb(136, 188, 116);"></div>
                <div onclick="updateDoorColor('orange')" class="option" style="background: rgb(234, 101, 94);"></div>
                <div onclick="updateDoorColor('blue')" class="option" style="background: rgb(70, 98, 230);"></div>
                <div onclick="updateDoorColor('pink')" class="option" style="background: rgb(228, 185, 176);"></div>
                <div onclick="updateDoorColor('greygreen')" class="option" style="background: rgb(96, 170, 166);"></div>
            </div>
        </div>

        <div class="container">
            <div class="scrollable-column">

                <div id="inner-container"></div>
            </div>
        </div>

    </div>

    <a href="/address">
        <div class="whereToGo" id="text">Where To Go?<img class="forwardArrow" src="../static/imga/backArrow.png"></div>
    </a>






    <script>
        let lastClickedDoor = `../static/img/door/blue/door0-blue.png`;
        let lastClickedFrame = `../static/img/Frame/blue/Frame1-blue.png`;


        function loadInitialImages() {
            var color = "blue";

            var container = document.getElementById('frame-container');
            for (let i = 1; i <= 10; i++) {
                const img = new Image();
                img.src = `../static/img/Frame/${color}/Frame${i}-${color}.png`;

                if (i == 1) {
                    img.classList.add('active')
                    lastClickedFrame = img;
                }

                img.addEventListener('click', function () {
                    if (lastClickedFrame) {
                        lastClickedFrame.classList.remove('active'); // Remove the active class from the previous image
                    }
                    lastClickedFrame = this; // Update the last clicked image to this one
                    this.classList.add('active'); // Add the active class to make this image colorful
                    updateImageSource();
                });
                container.appendChild(img);
            }


            container = document.getElementById('inner-container');
            for (let i = 1; i <= 10; i++) {
                const img = new Image();
                img.src = `../static/img/door/${color}/door${i}-${color}.png`;

                if (i == 1) {
                    img.classList.add('active')
                    lastClickedDoor = img;
                }

                img.addEventListener('click', function () {
                    if (lastClickedDoor) {
                        lastClickedDoor.classList.remove('active'); // Remove the active class from the previous image
                    }
                    lastClickedDoor = this; // Update the last clicked image to this one
                    this.classList.add('active'); // Add the active class to make this image colorful
                    updateImageSource();
                });
                container.appendChild(img);
            }

            updateImageSource();
        }





        function updateDoorColor(color) {
            if (lastClickedDoor) {
                lastClickedDoor.src = lastClickedDoor.src.replace(/(\w+)\/(\w+)-\w+\.png$/, `${color}/$2-${color}.png`);
                updateImageSource();
            }
            if (lastClickedFrame) {
                lastClickedFrame.src = lastClickedFrame.src.replace(/(\w+)\/(\w+)-\w+\.png$/, `${color}/$2-${color}.png`);
                updateImageSource();
            }
        }




        function generateCustomPath(img1, img2) {
            // Regular expression to extract the base name (e.g., "Frame2") and color from the frame URL
            const frameRegex = /\/Frame\/\w+\/(Frame\d+)-\w+\.png$/;
            const frameMatch = img1.src.match(frameRegex);
            const frameBaseName = frameMatch ? frameMatch[1] : null;

            // Regular expression to extract the base name (e.g., "door1") and color from the door URL
            const doorRegex = /\/door\/\w+\/(door\d+)-(\w+)\.png$/;
            const doorMatch = img2.src.match(doorRegex);
            const doorBaseName = doorMatch ? doorMatch[1] : null;
            const colorFromImg2 = doorMatch ? doorMatch[2] : null;

            // Combining the extracted parts into the final path
            if (frameBaseName && doorBaseName && colorFromImg2) {
                return `${frameBaseName}-${colorFromImg2}-${doorBaseName}`;
            } else {
                return "Invalid path"; // Return an error message if regex fails
            }
        }

        function updateImageSource() {
            const resultPath = generateCustomPath(lastClickedFrame, lastClickedDoor);
            console.log(resultPath)
            document.getElementById('resultImage').src = `../static/img/combined/${resultPath}.png`;
            sessionStorage.setItem('doorName', `${resultPath}.png`);
        }



        document.addEventListener('DOMContentLoaded', loadInitialImages);
    </script>
</body>

</html>